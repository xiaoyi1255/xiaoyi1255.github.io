<!DOCTYPE html>
<html lang="en-US" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>网络 | 前端缓存</title>
    <meta name="description" content="A VitePress site">
    <link rel="preload stylesheet" href="/assets/style.3c44adb5.css" as="style">
    <script type="module" src="/assets/app.08b1b7ec.js"></script>
    <link rel="preload" href="/assets/inter-roman-latin.2ed14f66.woff2" as="font" type="font/woff2" crossorigin="">
  <link rel="modulepreload" href="/assets/chunks/framework.1456bef9.js">
  <link rel="modulepreload" href="/assets/chunks/theme.875958b5.js">
  <link rel="modulepreload" href="/assets/guide_network_httpCache.md.e64df2d0.lean.js">
  <meta name="theme-color" content="#3c8772">
  <meta name="referrer" content="no-referrer">
  <script src="https://unpkg.com/valine/dist/Valine.min.js"></script>
  <script id="check-dark-light">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-410c024d><!--[--><!--]--><!--[--><span tabindex="-1" data-v-c8616af1></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-c8616af1> Skip to content </a><!--]--><!----><header class="VPNav" data-v-410c024d data-v-7e5bc4a5><div class="VPNavBar has-sidebar" data-v-7e5bc4a5 data-v-1d30fa41><div class="container" data-v-1d30fa41><div class="title" data-v-1d30fa41><div class="VPNavBarTitle has-sidebar" data-v-1d30fa41 data-v-f4ef19a3><a class="title" href="/" data-v-f4ef19a3><!--[--><!--]--><!----><!--[-->小易<!--]--><!--[--><!--]--></a></div></div><div class="content" data-v-1d30fa41><div class="curtain" data-v-1d30fa41></div><div class="content-body" data-v-1d30fa41><!--[--><!--]--><div class="VPNavBarSearch search" data-v-1d30fa41 style="--673bc564:&#39;Meta&#39;;"><div id="docsearch"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg class="DocSearch-Search-Icon" width="20" height="20" viewBox="0 0 20 20" aria-label="search icon"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"><kbd class="DocSearch-Button-Key"></kbd><kbd class="DocSearch-Button-Key">K</kbd></span></button></div></div><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-1d30fa41 data-v-7f418b0f><span id="main-nav-aria-label" class="visually-hidden" data-v-7f418b0f>Main Navigation</span><!--[--><!--[--><a class="VPLink link VPNavBarMenuLink active" href="/guide/test" tabindex="0" data-v-7f418b0f data-v-37adc828 data-v-8f4dc553><!--[-->Guide<!--]--><!----></a><!--]--><!--[--><div class="VPFlyout VPNavBarMenuGroup" data-v-7f418b0f data-v-764effdf><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-764effdf><span class="text" data-v-764effdf><!----> Dart基础语法 <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="text-icon" data-v-764effdf><path d="M12,16c-0.3,0-0.5-0.1-0.7-0.3l-6-6c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l5.3,5.3l5.3-5.3c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-6,6C12.5,15.9,12.3,16,12,16z"></path></svg></span></button><div class="menu" data-v-764effdf><div class="VPMenu" data-v-764effdf data-v-e7ea1737><div class="items" data-v-e7ea1737><!--[--><!--[--><div class="VPMenuLink" data-v-e7ea1737 data-v-d2c93bab><a class="VPLink link" href="/flutter/num" data-v-d2c93bab data-v-8f4dc553><!--[-->dart基础类型之num<!--]--><!----></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-e7ea1737 data-v-d2c93bab><a class="VPLink link" href="/flutter/string" data-v-d2c93bab data-v-8f4dc553><!--[-->dart基础类型之Sting<!--]--><!----></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-e7ea1737 data-v-d2c93bab><a class="VPLink link" href="/flutter/List" data-v-d2c93bab data-v-8f4dc553><!--[-->dart类型之List<!--]--><!----></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-e7ea1737 data-v-d2c93bab><a class="VPLink link" href="/flutter/Map" data-v-d2c93bab data-v-8f4dc553><!--[-->dart类型之Map<!--]--><!----></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-e7ea1737 data-v-d2c93bab><a class="VPLink link" href="/flutter/Set" data-v-d2c93bab data-v-8f4dc553><!--[-->dart类型之Set<!--]--><!----></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-e7ea1737 data-v-d2c93bab><a class="VPLink link" href="/flutter/Class" data-v-d2c93bab data-v-8f4dc553><!--[-->dart之Class<!--]--><!----></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-e7ea1737 data-v-d2c93bab><a class="VPLink link" href="/flutter/Function" data-v-d2c93bab data-v-8f4dc553><!--[-->dart之Function<!--]--><!----></a></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--]--></nav><!----><div class="VPNavBarAppearance appearance" data-v-1d30fa41 data-v-f6a63727><label title="toggle dark mode" data-v-f6a63727 data-v-a9c8afb8><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" aria-checked="false" data-v-a9c8afb8 data-v-f3c41672><span class="check" data-v-f3c41672><span class="icon" data-v-f3c41672><!--[--><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="sun" data-v-a9c8afb8><path d="M12,18c-3.3,0-6-2.7-6-6s2.7-6,6-6s6,2.7,6,6S15.3,18,12,18zM12,8c-2.2,0-4,1.8-4,4c0,2.2,1.8,4,4,4c2.2,0,4-1.8,4-4C16,9.8,14.2,8,12,8z"></path><path d="M12,4c-0.6,0-1-0.4-1-1V1c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,3.6,12.6,4,12,4z"></path><path d="M12,24c-0.6,0-1-0.4-1-1v-2c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,23.6,12.6,24,12,24z"></path><path d="M5.6,6.6c-0.3,0-0.5-0.1-0.7-0.3L3.5,4.9c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C6.2,6.5,5.9,6.6,5.6,6.6z"></path><path d="M19.8,20.8c-0.3,0-0.5-0.1-0.7-0.3l-1.4-1.4c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C20.3,20.7,20,20.8,19.8,20.8z"></path><path d="M3,13H1c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S3.6,13,3,13z"></path><path d="M23,13h-2c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S23.6,13,23,13z"></path><path d="M4.2,20.8c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C4.7,20.7,4.5,20.8,4.2,20.8z"></path><path d="M18.4,6.6c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C18.9,6.5,18.6,6.6,18.4,6.6z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="moon" data-v-a9c8afb8><path d="M12.1,22c-0.3,0-0.6,0-0.9,0c-5.5-0.5-9.5-5.4-9-10.9c0.4-4.8,4.2-8.6,9-9c0.4,0,0.8,0.2,1,0.5c0.2,0.3,0.2,0.8-0.1,1.1c-2,2.7-1.4,6.4,1.3,8.4c2.1,1.6,5,1.6,7.1,0c0.3-0.2,0.7-0.3,1.1-0.1c0.3,0.2,0.5,0.6,0.5,1c-0.2,2.7-1.5,5.1-3.6,6.8C16.6,21.2,14.4,22,12.1,22zM9.3,4.4c-2.9,1-5,3.6-5.2,6.8c-0.4,4.4,2.8,8.3,7.2,8.7c2.1,0.2,4.2-0.4,5.8-1.8c1.1-0.9,1.9-2.1,2.4-3.4c-2.5,0.9-5.3,0.5-7.5-1.1C9.2,11.4,8.1,7.7,9.3,4.4z"></path></svg><!--]--></span></span></button></label></div><div class="VPSocialLinks VPNavBarSocialLinks social-links" data-v-1d30fa41 data-v-0394ad82 data-v-f6988cfb><!--[--><a class="VPSocialLink" href="https://github.com/xiaoyi1255" aria-label="github" target="_blank" rel="noopener" data-v-f6988cfb data-v-c530cc0a><svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>GitHub</title><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"/></svg></a><!--]--></div><div class="VPFlyout VPNavBarExtra extra" data-v-1d30fa41 data-v-40855f84 data-v-764effdf><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-764effdf><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="icon" data-v-764effdf><circle cx="12" cy="12" r="2"></circle><circle cx="19" cy="12" r="2"></circle><circle cx="5" cy="12" r="2"></circle></svg></button><div class="menu" data-v-764effdf><div class="VPMenu" data-v-764effdf data-v-e7ea1737><!----><!--[--><!--[--><!----><div class="group" data-v-40855f84><div class="item appearance" data-v-40855f84><p class="label" data-v-40855f84>Appearance</p><div class="appearance-action" data-v-40855f84><label title="toggle dark mode" data-v-40855f84 data-v-a9c8afb8><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" aria-checked="false" data-v-a9c8afb8 data-v-f3c41672><span class="check" data-v-f3c41672><span class="icon" data-v-f3c41672><!--[--><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="sun" data-v-a9c8afb8><path d="M12,18c-3.3,0-6-2.7-6-6s2.7-6,6-6s6,2.7,6,6S15.3,18,12,18zM12,8c-2.2,0-4,1.8-4,4c0,2.2,1.8,4,4,4c2.2,0,4-1.8,4-4C16,9.8,14.2,8,12,8z"></path><path d="M12,4c-0.6,0-1-0.4-1-1V1c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,3.6,12.6,4,12,4z"></path><path d="M12,24c-0.6,0-1-0.4-1-1v-2c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,23.6,12.6,24,12,24z"></path><path d="M5.6,6.6c-0.3,0-0.5-0.1-0.7-0.3L3.5,4.9c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C6.2,6.5,5.9,6.6,5.6,6.6z"></path><path d="M19.8,20.8c-0.3,0-0.5-0.1-0.7-0.3l-1.4-1.4c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C20.3,20.7,20,20.8,19.8,20.8z"></path><path d="M3,13H1c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S3.6,13,3,13z"></path><path d="M23,13h-2c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S23.6,13,23,13z"></path><path d="M4.2,20.8c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C4.7,20.7,4.5,20.8,4.2,20.8z"></path><path d="M18.4,6.6c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C18.9,6.5,18.6,6.6,18.4,6.6z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="moon" data-v-a9c8afb8><path d="M12.1,22c-0.3,0-0.6,0-0.9,0c-5.5-0.5-9.5-5.4-9-10.9c0.4-4.8,4.2-8.6,9-9c0.4,0,0.8,0.2,1,0.5c0.2,0.3,0.2,0.8-0.1,1.1c-2,2.7-1.4,6.4,1.3,8.4c2.1,1.6,5,1.6,7.1,0c0.3-0.2,0.7-0.3,1.1-0.1c0.3,0.2,0.5,0.6,0.5,1c-0.2,2.7-1.5,5.1-3.6,6.8C16.6,21.2,14.4,22,12.1,22zM9.3,4.4c-2.9,1-5,3.6-5.2,6.8c-0.4,4.4,2.8,8.3,7.2,8.7c2.1,0.2,4.2-0.4,5.8-1.8c1.1-0.9,1.9-2.1,2.4-3.4c-2.5,0.9-5.3,0.5-7.5-1.1C9.2,11.4,8.1,7.7,9.3,4.4z"></path></svg><!--]--></span></span></button></label></div></div></div><div class="group" data-v-40855f84><div class="item social-links" data-v-40855f84><div class="VPSocialLinks social-links-list" data-v-40855f84 data-v-f6988cfb><!--[--><a class="VPSocialLink" href="https://github.com/xiaoyi1255" aria-label="github" target="_blank" rel="noopener" data-v-f6988cfb data-v-c530cc0a><svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>GitHub</title><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"/></svg></a><!--]--></div></div></div><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-1d30fa41 data-v-e5dd9c1c><span class="container" data-v-e5dd9c1c><span class="top" data-v-e5dd9c1c></span><span class="middle" data-v-e5dd9c1c></span><span class="bottom" data-v-e5dd9c1c></span></span></button></div></div></div></div><!----></header><div class="VPLocalNav" data-v-410c024d data-v-f5a2ca58><button class="menu" aria-expanded="false" aria-controls="VPSidebarNav" data-v-f5a2ca58><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="menu-icon" data-v-f5a2ca58><path d="M17,11H3c-0.6,0-1-0.4-1-1s0.4-1,1-1h14c0.6,0,1,0.4,1,1S17.6,11,17,11z"></path><path d="M21,7H3C2.4,7,2,6.6,2,6s0.4-1,1-1h18c0.6,0,1,0.4,1,1S21.6,7,21,7z"></path><path d="M21,15H3c-0.6,0-1-0.4-1-1s0.4-1,1-1h18c0.6,0,1,0.4,1,1S21.6,15,21,15z"></path><path d="M17,19H3c-0.6,0-1-0.4-1-1s0.4-1,1-1h14c0.6,0,1,0.4,1,1S17.6,19,17,19z"></path></svg><span class="menu-text" data-v-f5a2ca58>Menu</span></button><div class="VPLocalNavOutlineDropdown" style="--vp-vh:0px;" data-v-f5a2ca58 data-v-5b5709e9><button data-v-5b5709e9>Return to top</button><!----></div></div><aside class="VPSidebar" data-v-410c024d data-v-139a1f1d><div class="curtain" data-v-139a1f1d></div><nav class="nav" id="VPSidebarNav" aria-labelledby="sidebar-aria-label" tabindex="-1" data-v-139a1f1d><span class="visually-hidden" id="sidebar-aria-label" data-v-139a1f1d> Sidebar Navigation </span><!--[--><!--]--><!--[--><div class="group" data-v-139a1f1d><section class="VPSidebarItem level-0 collapsible collapsed" data-v-139a1f1d data-v-c4656e6d><div class="item" role="button" tabindex="0" data-v-c4656e6d><div class="indicator" data-v-c4656e6d></div><h2 class="text" data-v-c4656e6d>Vue3源码学习</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-c4656e6d><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="caret-icon" data-v-c4656e6d><path d="M9,19c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l5.3-5.3L8.3,6.7c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l6,6c0.4,0.4,0.4,1,0,1.4l-6,6C9.5,18.9,9.3,19,9,19z"></path></svg></div></div><div class="items" data-v-c4656e6d><!--[--><div class="VPSidebarItem level-1 is-link" data-v-c4656e6d data-v-c4656e6d><div class="item" data-v-c4656e6d><div class="indicator" data-v-c4656e6d></div><a class="VPLink link link" href="/guide/vue/ref" data-v-c4656e6d data-v-8f4dc553><!--[--><p class="text" data-v-c4656e6d>ref+依赖收集+更新</p><!--]--><!----></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-c4656e6d data-v-c4656e6d><div class="item" data-v-c4656e6d><div class="indicator" data-v-c4656e6d></div><a class="VPLink link link" href="/guide/vue/reactive" data-v-c4656e6d data-v-8f4dc553><!--[--><p class="text" data-v-c4656e6d>reactive</p><!--]--><!----></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-c4656e6d data-v-c4656e6d><div class="item" data-v-c4656e6d><div class="indicator" data-v-c4656e6d></div><a class="VPLink link link" href="/guide/vue/computed" data-v-c4656e6d data-v-8f4dc553><!--[--><p class="text" data-v-c4656e6d>computed</p><!--]--><!----></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-c4656e6d data-v-c4656e6d><div class="item" data-v-c4656e6d><div class="indicator" data-v-c4656e6d></div><a class="VPLink link link" href="/guide/vue/effect" data-v-c4656e6d data-v-8f4dc553><!--[--><p class="text" data-v-c4656e6d>effect</p><!--]--><!----></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-c4656e6d data-v-c4656e6d><div class="item" data-v-c4656e6d><div class="indicator" data-v-c4656e6d></div><a class="VPLink link link" href="/guide/vue/intercept" data-v-c4656e6d data-v-8f4dc553><!--[--><p class="text" data-v-c4656e6d>拦截工具函数</p><!--]--><!----></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-c4656e6d data-v-c4656e6d><div class="item" data-v-c4656e6d><div class="indicator" data-v-c4656e6d></div><a class="VPLink link link" href="/guide/vue/watch" data-v-c4656e6d data-v-8f4dc553><!--[--><p class="text" data-v-c4656e6d>watch & watchEffect</p><!--]--><!----></a><!----></div><!----></div><!--]--></div></section></div><div class="group" data-v-139a1f1d><section class="VPSidebarItem level-0 collapsible has-active" data-v-139a1f1d data-v-c4656e6d><div class="item" role="button" tabindex="0" data-v-c4656e6d><div class="indicator" data-v-c4656e6d></div><h2 class="text" data-v-c4656e6d>网络请求</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-c4656e6d><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="caret-icon" data-v-c4656e6d><path d="M9,19c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l5.3-5.3L8.3,6.7c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l6,6c0.4,0.4,0.4,1,0,1.4l-6,6C9.5,18.9,9.3,19,9,19z"></path></svg></div></div><div class="items" data-v-c4656e6d><!--[--><div class="VPSidebarItem level-1 is-link is-active has-active" data-v-c4656e6d data-v-c4656e6d><div class="item" data-v-c4656e6d><div class="indicator" data-v-c4656e6d></div><a class="VPLink link link" href="/guide/network/httpCache" data-v-c4656e6d data-v-8f4dc553><!--[--><p class="text" data-v-c4656e6d>http缓存</p><!--]--><!----></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-c4656e6d data-v-c4656e6d><div class="item" data-v-c4656e6d><div class="indicator" data-v-c4656e6d></div><a class="VPLink link link" href="/guide/network/serviceWorker" data-v-c4656e6d data-v-8f4dc553><!--[--><p class="text" data-v-c4656e6d>service Worker缓存</p><!--]--><!----></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-c4656e6d data-v-c4656e6d><div class="item" data-v-c4656e6d><div class="indicator" data-v-c4656e6d></div><a class="VPLink link link" href="/guide/network/axios" data-v-c4656e6d data-v-8f4dc553><!--[--><p class="text" data-v-c4656e6d>axios 取消重复请求</p><!--]--><!----></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-c4656e6d data-v-c4656e6d><div class="item" data-v-c4656e6d><div class="indicator" data-v-c4656e6d></div><a class="VPLink link link" href="/guide/network/dataCache" data-v-c4656e6d data-v-8f4dc553><!--[--><p class="text" data-v-c4656e6d>接口数据缓存</p><!--]--><!----></a><!----></div><!----></div><!--]--></div></section></div><div class="group" data-v-139a1f1d><section class="VPSidebarItem level-0 collapsible collapsed" data-v-139a1f1d data-v-c4656e6d><div class="item" role="button" tabindex="0" data-v-c4656e6d><div class="indicator" data-v-c4656e6d></div><h2 class="text" data-v-c4656e6d>项目搭建</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-c4656e6d><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="caret-icon" data-v-c4656e6d><path d="M9,19c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l5.3-5.3L8.3,6.7c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l6,6c0.4,0.4,0.4,1,0,1.4l-6,6C9.5,18.9,9.3,19,9,19z"></path></svg></div></div><div class="items" data-v-c4656e6d><!--[--><div class="VPSidebarItem level-1 is-link" data-v-c4656e6d data-v-c4656e6d><div class="item" data-v-c4656e6d><div class="indicator" data-v-c4656e6d></div><a class="VPLink link link" href="/guide/project/blog" data-v-c4656e6d data-v-8f4dc553><!--[--><p class="text" data-v-c4656e6d>vitepress搭建技术文档、个人博客</p><!--]--><!----></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-c4656e6d data-v-c4656e6d><div class="item" data-v-c4656e6d><div class="indicator" data-v-c4656e6d></div><a class="VPLink link link" href="/guide/project/algolia" data-v-c4656e6d data-v-8f4dc553><!--[--><p class="text" data-v-c4656e6d>给vitepress加上全局搜索</p><!--]--><!----></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-c4656e6d data-v-c4656e6d><div class="item" data-v-c4656e6d><div class="indicator" data-v-c4656e6d></div><a class="VPLink link link" href="/guide/project/nuxt3" data-v-c4656e6d data-v-8f4dc553><!--[--><p class="text" data-v-c4656e6d>nuxt3 搭建项目</p><!--]--><!----></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-c4656e6d data-v-c4656e6d><div class="item" data-v-c4656e6d><div class="indicator" data-v-c4656e6d></div><a class="VPLink link link" href="/guide/project/nodemailer" data-v-c4656e6d data-v-8f4dc553><!--[--><p class="text" data-v-c4656e6d>nodemailer实现邮件发送</p><!--]--><!----></a><!----></div><!----></div><section class="VPSidebarItem level-1 collapsible collapsed" data-v-c4656e6d data-v-c4656e6d><div class="item" role="button" tabindex="0" data-v-c4656e6d><div class="indicator" data-v-c4656e6d></div><h3 class="text" data-v-c4656e6d>构建高效的聊天室</h3><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-c4656e6d><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="caret-icon" data-v-c4656e6d><path d="M9,19c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l5.3-5.3L8.3,6.7c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l6,6c0.4,0.4,0.4,1,0,1.4l-6,6C9.5,18.9,9.3,19,9,19z"></path></svg></div></div><div class="items" data-v-c4656e6d><!--[--><div class="VPSidebarItem level-2 is-link" data-v-c4656e6d data-v-c4656e6d><div class="item" data-v-c4656e6d><div class="indicator" data-v-c4656e6d></div><a class="VPLink link link" href="/guide/chat/websocket" data-v-c4656e6d data-v-8f4dc553><!--[--><p class="text" data-v-c4656e6d>1.websocket实现基础通信</p><!--]--><!----></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-c4656e6d data-v-c4656e6d><div class="item" data-v-c4656e6d><div class="indicator" data-v-c4656e6d></div><a class="VPLink link link" href="/guide/chat/websocket2" data-v-c4656e6d data-v-8f4dc553><!--[--><p class="text" data-v-c4656e6d>2.支持图片、视频消息</p><!--]--><!----></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-c4656e6d data-v-c4656e6d><div class="item" data-v-c4656e6d><div class="indicator" data-v-c4656e6d></div><a class="VPLink link link" href="/guide/chat/redis" data-v-c4656e6d data-v-8f4dc553><!--[--><p class="text" data-v-c4656e6d>3.消息转存redis</p><!--]--><!----></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-c4656e6d data-v-c4656e6d><div class="item" data-v-c4656e6d><div class="indicator" data-v-c4656e6d></div><a class="VPLink link link" href="/guide/chat/heartbeat" data-v-c4656e6d data-v-8f4dc553><!--[--><p class="text" data-v-c4656e6d>4.在线状态管理：心跳机制</p><!--]--><!----></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-c4656e6d data-v-c4656e6d><div class="item" data-v-c4656e6d><div class="indicator" data-v-c4656e6d></div><a class="VPLink link link" href="/guide/chat/uploadLargeFile" data-v-c4656e6d data-v-8f4dc553><!--[--><p class="text" data-v-c4656e6d>5.实现大文件分片上传</p><!--]--><!----></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-c4656e6d data-v-c4656e6d><div class="item" data-v-c4656e6d><div class="indicator" data-v-c4656e6d></div><a class="VPLink link link" href="/guide/chat/cloud" data-v-c4656e6d data-v-8f4dc553><!--[--><p class="text" data-v-c4656e6d>6.腾讯云服务器进行项目PM2部署</p><!--]--><!----></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-c4656e6d data-v-c4656e6d><div class="item" data-v-c4656e6d><div class="indicator" data-v-c4656e6d></div><a class="VPLink link link" href="/guide/chat/wechatLogin" data-v-c4656e6d data-v-8f4dc553><!--[--><p class="text" data-v-c4656e6d>7.微信订阅号实现登录</p><!--]--><!----></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-c4656e6d data-v-c4656e6d><div class="item" data-v-c4656e6d><div class="indicator" data-v-c4656e6d></div><a class="VPLink link link" href="/guide/chat/emoji" data-v-c4656e6d data-v-8f4dc553><!--[--><p class="text" data-v-c4656e6d>8.支持emoji表情</p><!--]--><!----></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-c4656e6d data-v-c4656e6d><div class="item" data-v-c4656e6d><div class="indicator" data-v-c4656e6d></div><a class="VPLink link link" href="/guide/chat/fiveline" data-v-c4656e6d data-v-8f4dc553><!--[--><p class="text" data-v-c4656e6d>9.五子棋在线对战</p><!--]--><!----></a><!----></div><!----></div><!--]--></div></section><div class="VPSidebarItem level-1 is-link" data-v-c4656e6d data-v-c4656e6d><div class="item" data-v-c4656e6d><div class="indicator" data-v-c4656e6d></div><a class="VPLink link link" href="/guide/chat/token" data-v-c4656e6d data-v-8f4dc553><!--[--><p class="text" data-v-c4656e6d>无感刷新Token</p><!--]--><!----></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-c4656e6d data-v-c4656e6d><div class="item" data-v-c4656e6d><div class="indicator" data-v-c4656e6d></div><a class="VPLink link link" href="/guide/project/obfuscator" data-v-c4656e6d data-v-8f4dc553><!--[--><p class="text" data-v-c4656e6d>vue项目代码混淆</p><!--]--><!----></a><!----></div><!----></div><!--]--></div></section></div><div class="group" data-v-139a1f1d><section class="VPSidebarItem level-0 collapsible collapsed" data-v-139a1f1d data-v-c4656e6d><div class="item" role="button" tabindex="0" data-v-c4656e6d><div class="indicator" data-v-c4656e6d></div><h2 class="text" data-v-c4656e6d>JS面试系列</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-c4656e6d><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="caret-icon" data-v-c4656e6d><path d="M9,19c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l5.3-5.3L8.3,6.7c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l6,6c0.4,0.4,0.4,1,0,1.4l-6,6C9.5,18.9,9.3,19,9,19z"></path></svg></div></div><div class="items" data-v-c4656e6d><!--[--><div class="VPSidebarItem level-1 is-link" data-v-c4656e6d data-v-c4656e6d><div class="item" data-v-c4656e6d><div class="indicator" data-v-c4656e6d></div><a class="VPLink link link" href="/guide/js/arraryEqual" data-v-c4656e6d data-v-8f4dc553><!--[--><p class="text" data-v-c4656e6d>1、判断两数组内容相等</p><!--]--><!----></a><!----></div><!----></div><!--]--></div></section></div><div class="group" data-v-139a1f1d><section class="VPSidebarItem level-0 collapsible collapsed" data-v-139a1f1d data-v-c4656e6d><div class="item" role="button" tabindex="0" data-v-c4656e6d><div class="indicator" data-v-c4656e6d></div><h2 class="text" data-v-c4656e6d>工具集</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-c4656e6d><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="caret-icon" data-v-c4656e6d><path d="M9,19c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l5.3-5.3L8.3,6.7c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l6,6c0.4,0.4,0.4,1,0,1.4l-6,6C9.5,18.9,9.3,19,9,19z"></path></svg></div></div><div class="items" data-v-c4656e6d><!--[--><div class="VPSidebarItem level-1 is-link" data-v-c4656e6d data-v-c4656e6d><div class="item" data-v-c4656e6d><div class="indicator" data-v-c4656e6d></div><a class="VPLink link link" href="/guide/utils/ngrok" data-v-c4656e6d data-v-8f4dc553><!--[--><p class="text" data-v-c4656e6d>免费的内网穿透工具: ngrok</p><!--]--><!----></a><!----></div><!----></div><!--]--></div></section></div><div class="group" data-v-139a1f1d><section class="VPSidebarItem level-0 collapsible collapsed" data-v-139a1f1d data-v-c4656e6d><div class="item" role="button" tabindex="0" data-v-c4656e6d><div class="indicator" data-v-c4656e6d></div><h2 class="text" data-v-c4656e6d>那些年踩过的坑</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-c4656e6d><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="caret-icon" data-v-c4656e6d><path d="M9,19c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l5.3-5.3L8.3,6.7c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l6,6c0.4,0.4,0.4,1,0,1.4l-6,6C9.5,18.9,9.3,19,9,19z"></path></svg></div></div><div class="items" data-v-c4656e6d><!--[--><div class="VPSidebarItem level-1 is-link" data-v-c4656e6d data-v-c4656e6d><div class="item" data-v-c4656e6d><div class="indicator" data-v-c4656e6d></div><a class="VPLink link link" href="/guide/bug/index" data-v-c4656e6d data-v-8f4dc553><!--[--><p class="text" data-v-c4656e6d>同学醒醒，bug来了</p><!--]--><!----></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-c4656e6d data-v-c4656e6d><div class="item" data-v-c4656e6d><div class="indicator" data-v-c4656e6d></div><a class="VPLink link link" href="/guide/bug/message" data-v-c4656e6d data-v-8f4dc553><!--[--><p class="text" data-v-c4656e6d>ant-design-vue的message</p><!--]--><!----></a><!----></div><!----></div><!--]--></div></section></div><!--]--><!--[--><!--]--></nav></aside><div class="VPContent has-sidebar" id="VPContent" data-v-410c024d data-v-bcaf6df5><div class="VPDoc has-sidebar has-aside" data-v-bcaf6df5 data-v-b7630eba><div class="container" data-v-b7630eba><div class="aside" data-v-b7630eba><div class="aside-curtain" data-v-b7630eba></div><div class="aside-container" data-v-b7630eba><div class="aside-content" data-v-b7630eba><div class="VPDocAside" data-v-b7630eba data-v-3f215769><!--[--><!--]--><!--[--><!--]--><div class="VPDocAsideOutline" data-v-3f215769 data-v-ff0f39c8><div class="content" data-v-ff0f39c8><div class="outline-marker" data-v-ff0f39c8></div><div class="outline-title" data-v-ff0f39c8>On this page</div><nav aria-labelledby="doc-outline-aria-label" data-v-ff0f39c8><span class="visually-hidden" id="doc-outline-aria-label" data-v-ff0f39c8> Table of Contents for current page </span><ul class="root" data-v-ff0f39c8 data-v-8f12e865><!--[--><!--]--></ul></nav></div></div><!--[--><!--]--><div class="spacer" data-v-3f215769></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-b7630eba><div class="content-container" data-v-b7630eba><!--[--><!--]--><!----><main class="main" data-v-b7630eba><div style="position:relative;" class="vp-doc _guide_network_httpCache" data-v-b7630eba><div><h2 id="前言" tabindex="-1">前言 <a class="header-anchor" href="#前言" aria-label="Permalink to &quot;前言 {#前言}&quot;">​</a></h2><p>大家好！我是程序员小易！这是我的第一篇文章，一些的不足或描述不清晰是地方，欢迎大家评论区指正。一起学习、一起进步！</p><hr><p><strong>本文：</strong> 介绍了什么是http缓存、优先级、优缺点及代码实现</p><p><strong>资源</strong>：可以是访问过的静态资源（css、js、图片、页面、时效不高的接口）</p><p><strong>分类</strong>：服务器缓存、CDN缓存、http缓存</p><h3 id="我们为什么需要http缓存" tabindex="-1">我们为什么需要http缓存？ <a class="header-anchor" href="#我们为什么需要http缓存" aria-label="Permalink to &quot;我们为什么需要http缓存？&quot;">​</a></h3><pre><code>因为缓存可以节省网络资源、提高网页性能、降低服务器压力
</code></pre><h3 id="什么是http缓存" tabindex="-1">什么是http缓存 <a class="header-anchor" href="#什么是http缓存" aria-label="Permalink to &quot;什么是http缓存&quot;">​</a></h3><p>HTTP缓存是指在客户端（如浏览器）或者代理服务器（如CDN）中存储之前获取的Web资源的副本，当客户端或代理服务器再次请求该资源时，直接从本地缓存中获取，避免了重复的网络请求和服务器响应。常见的HTTP缓存包括强制缓存和协商缓存。 先上思维导图</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/b6d722cb3ebc4f66978255108deb2453~tplv-k3u1fbpfcp-watermark.image?" alt="http缓存思路导图.jpg"></p><p>http缓存也称浏览器缓存，就是：服务器通过header头告诉浏览器是否使用缓存，使用什么样的缓存规则？我们先认识一下缓存的优先级和请求头。</p><table><thead><tr><th>优先级</th><th>pragma&gt;Cache-Control&gt;Expire 强缓存&gt;协商缓存（也称弱缓存）</th></tr></thead><tbody><tr><td>pragma</td><td>no-cache，用于请求头，效果和 Cache-control:no-cache 一致</td></tr><tr><td>Last-Modified/if-modified-since</td><td>表示服务器上资源的最后修改时间, 格林尼治时间 前者为响应头、后者为请求头</td></tr><tr><td>ETag/If-None-Match</td><td>表示资源的唯一标识，可以根据文件的内容自定义生成hash;前者为响应头、后者为请求头</td></tr><tr><td></td><td>1、private：私有缓存：指令表明响应只能存储在私有缓存中（例如浏览器中的本地缓存）</td></tr><tr><td></td><td>2、public：共享缓存：客户端和服务器、代理服务器都可以缓存；表示响应可以存储在共享缓存中。带有标头字段的请求的响应Authorization不能存储在共享缓存中；但是，该public指令将导致此类响应存储在共享缓存中</td></tr><tr><td></td><td>3、max-age=seconds:相对时间：响应指令指示响应在生成响应后N秒之前保持新</td></tr><tr><td></td><td>4、s-maxage: 指令还指示响应的新鲜时间（类似于max-age） - 但它特定于共享缓存，max-age当它存在时它们将被忽略</td></tr><tr><td>Cache-Control</td><td>5no-cache: 响应可以存储在缓存中，但响应必须在每次重用之前与源服务器进行验证，即使缓存与源服务器断开连接也是如此</td></tr><tr><td></td><td>6、no-store: 所以内容都不会被缓存，强制缓存和协商缓存也不会触发</td></tr><tr><td></td><td>7、no-transform: 代理不可更改媒体类型</td></tr><tr><td></td><td>8、must-revalidate</td></tr><tr><td></td><td>9、proxy-revalidate</td></tr><tr><td></td><td>10、min-fresh</td></tr><tr><td></td><td>11、max-stale</td></tr></tbody></table><h2 id="http缓存流程" tabindex="-1">http缓存流程 <a class="header-anchor" href="#http缓存流程" aria-label="Permalink to &quot;http缓存流程 {#http缓存流程}&quot;">​</a></h2><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/dc17bf22cba149a6b019c735ad16f6f7~tplv-k3u1fbpfcp-watermark.image?" alt="image.png"></p><h2 id="怎样实现http缓存" tabindex="-1">怎样实现http缓存 <a class="header-anchor" href="#怎样实现http缓存" aria-label="Permalink to &quot;怎样实现http缓存 {#怎样实现http缓存}&quot;">​</a></h2><h3 id="准备工作" tabindex="-1">准备工作 <a class="header-anchor" href="#准备工作" aria-label="Permalink to &quot;准备工作&quot;">​</a></h3><p>这里使用 node 简单地搭建了个服务器，使用了node的fs模块和crypto模块</p><h4 id="crypto" tabindex="-1">crypto <a class="header-anchor" href="#crypto" aria-label="Permalink to &quot;crypto&quot;">​</a></h4><div class="language-typescript"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> crypto </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">require</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">crypto</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> hash </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> crypto</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">createHash</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">md5</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;font-style:italic;">// &#39;md5&#39; | &#39;sha1&#39; | &#39;sha256&#39; | &#39;ha512&#39;</span></span>
<span class="line"><span style="color:#A6ACCD;">hash</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">update</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">Hello</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;font-style:italic;">// 传入我们要生成hash 的内容</span></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> str </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> hash</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">digest</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">hex</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;font-style:italic;">// &#39;bin&#39; | &#39;base64&#39; 按照指定的格式进行加密</span></span>
<span class="line"></span></code></pre></div><p><code>fs</code></p><div class="language-typescript"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> fs </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">require</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">fs</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;font-style:italic;">// 引入fs模块</span></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> stats </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> fs</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">statSync</span><span style="color:#A6ACCD;">(path)</span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;font-style:italic;">// 通过传入路径，同步读取系统文件信息[修改时间、文件大小]</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// fs.stat(path, callback); // 异步读取，回调形式处理，读取结果</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// 1.stats.isFile(): 如果是文件则返回true,否则返回false;</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// 2.stats.isDirectiory(): 如果是目录则返回true,否则返回false;</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// 3.stats.isBlockDevice(): 如果是块设备则返回true，否则返回false;</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// 4.stats.isCharacterDevice(): 如果是字符设备返回true,否则返回false;</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// 5.stats.isSymbolicLink(): 如果是软链接返回true,否则返回false;</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// 6.stats.isFIFO(): 如果是FIFO,则返回true,否则返回false.FIFO是UNIX中的一种特殊类型的命令管道</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// 7.stats.isSocket(): 如果是Socket则返回true,否则返回false;</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// 8.stats.size(): 文件的大小（以字节为单位）。</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">fs</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">readFileSync</span><span style="color:#A6ACCD;">(path)</span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;font-style:italic;">// 同步读取 文件</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// fs.readFile(path,callback); // 异步读取文件</span></span>
<span class="line"></span></code></pre></div><p><code>服务器</code></p><p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/1c93eb6eaaa143b8ae3357b73132c4ab~tplv-k3u1fbpfcp-watermark.image?" alt="image.png"><code>读取资源：</code></p><p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/01e61807a3554f548addc57873b3a00f~tplv-k3u1fbpfcp-watermark.image?" alt="image.png"></p><h2 id="强制缓存" tabindex="-1">强制缓存 <a class="header-anchor" href="#强制缓存" aria-label="Permalink to &quot;强制缓存 {#强制缓存}&quot;">​</a></h2><p>强缓存主要使用<code>Expires</code>、<code>Cache-Control</code> 两个头字段，两者同时存在<code>Cache-Control</code>优先级更高。当命中强缓存的时候，客户端不会再求，直接从缓存中读取内容，并返回HTTP状态码<code>200</code>。这里就是无论 服务端的资源有没有发生改变，没有过期之前，都不会重新发送请求。</p><h4 id="expires" tabindex="-1">Expires <a class="header-anchor" href="#expires" aria-label="Permalink to &quot;Expires&quot;">​</a></h4><p>Expires：绝对时间，表明直到这个时间为止，都不需要找我。注意避坑：时间格式为：格林尼治时间：GMT。这是http1.0的产物，存在问题，所以在1.1版本推出了Cache-Control。<br> 先来看代码的实现：在请求<code>index.css</code>的时候给设置了<code>Expires</code>请求头。下面是第一请求<code>index.css</code>和第一次请求的浏览器截图。第一次请求图片，返回的状态码是200。表示改资源是从服务器读取的。</p><p><code>设置Expires</code></p><div class="language-typescript"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">res</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">setHeader</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">Expires</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">Date</span><span style="color:#A6ACCD;">(now </span><span style="color:#89DDFF;">+</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">5</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">60</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">1000</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">toUTCString</span><span style="color:#A6ACCD;">())</span></span>
<span class="line"></span></code></pre></div><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/dca2310b83c1422a9ecaa053228da26f~tplv-k3u1fbpfcp-watermark.image?" alt="image.png"></p><p>我们再看看第二次请求和第三次请求，状态码也是为200，但是服务器实际上没有接收到请求。读的是磁盘里面的缓存。</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/9c5f7d57898d497aabc3656f02c60516~tplv-k3u1fbpfcp-watermark.image?" alt="image.png"></p><h4 id="expires的不足" tabindex="-1">Expires的不足 <a class="header-anchor" href="#expires的不足" aria-label="Permalink to &quot;Expires的不足&quot;">​</a></h4><p>看到这，是不是觉得<code>Expires</code>太好用了，为什么还要在http1.1中新增<code>Cache-Control</code>?你可能想问：那如果资源设置了一个很长的过期时间，比如1年，但是期间，该资源被改变了，而前端是无感知的，前端还在用着旧版本。解决方案？请求资源拼上 版本号、时间戳等手段，就可以了。最致命的问题是：过期时间设置的是一个绝对时间，它没有发请求，在本地判断是否过期，用的客户端的时间和响应的<code>Expires</code>做判断。那么问题就来了：假如客户端的时间被修改了、就算时间没有被修改，也存在跨时区问题，不就乱套了么？所以<code>Cache-Control</code>还是很有必要滴。</p><h4 id="cache-control" tabindex="-1">Cache-Control <a class="header-anchor" href="#cache-control" aria-label="Permalink to &quot;Cache-Control&quot;">​</a></h4><p>：相对时间, 响应后N秒，资源保持新鲜，如1分钟之内，都不要找我，max-age=&quot;60&quot;,单位为秒、我们通过<code>max-age</code>设置的强制缓存,<code>header</code>头代码如下</p><div class="language-typescript"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">res</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">setHeader</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">Cache-Control</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">max-age=120</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;"> )</span></span>
<span class="line"></span></code></pre></div><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/5976280e4eaf46b5ad8419512568bab6~tplv-k3u1fbpfcp-watermark.image?" alt="image.png"></p><p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/0d7aa19c24194272b9b9def4a90de073~tplv-k3u1fbpfcp-watermark.image?" alt="image.png"> 由上图可知：设置了max-age 在没有到期之前，服务器也是没有接收到请求 的，直接在前端拿的缓存，并且返回的是<code>200</code>，接下来，去看看协商缓存。</p><h2 id="协商缓存" tabindex="-1">协商缓存 <a class="header-anchor" href="#协商缓存" aria-label="Permalink to &quot;协商缓存 {#协商缓存}&quot;">​</a></h2><p>协商缓存：顾名思义，它没有强制缓存那么硬气，需要去和服务端协商，到底用缓存？还是重新访问资源？协商缓存是希望通过对比文件的最后一次修改时间、文件内容hash来判断。这里涉及的两组header头：</p><h4 id="last-modified-if-modify-since" tabindex="-1">Last-Modified / If-Modify-Since <a class="header-anchor" href="#last-modified-if-modify-since" aria-label="Permalink to &quot;Last-Modified / If-Modify-Since&quot;">​</a></h4><p>表示：服务器对资源文件的最后一次修改时间</p><div class="language-typescript"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> fileModifyTime </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> fs</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">statSync</span><span style="color:#A6ACCD;">(url)</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">ctime</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">toUTCString</span><span style="color:#A6ACCD;">() </span><span style="color:#676E95;font-style:italic;">// 拿到系统文件修改时间</span></span>
<span class="line"><span style="color:#A6ACCD;">res</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">setHeader</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">Cache-Control</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">no-cache</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">res</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">setHeader</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">last-modified</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> fileModifyTime)</span></span>
<span class="line"></span></code></pre></div><p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/c17e897b250d4841a33117a5c19c007f~tplv-k3u1fbpfcp-watermark.image?" alt="image.png"></p><p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/d35c5b95d2fc468ba975cfcd1eb786e8~tplv-k3u1fbpfcp-watermark.image?" alt="image.png"> 第二次请求的时候，请求头携带了<code>if-modified-since</code>，就是第一次请求响应头的<code>last-modified</code>,服务器通过重新获取文件的最后一次修改时间，来对比。对比结果：文件未被修改，所以我们可以发现状态码为<code>304</code>，服务器也接收到了请求，这时候可能就有疑问了，协商缓存都又请求了一次，还不是浪费了网络资源，答案是：是！但是又不全是，因为，服务器是接收到请求了，也做了判断，但是结果是，可以继续使用缓存，所以服务器的响应体，并没有把资源返回给前端，<strong>资源还是从前端的缓存中读取的</strong></p><h4 id="last-modified的不足" tabindex="-1">Last-Modified的不足 <a class="header-anchor" href="#last-modified的不足" aria-label="Permalink to &quot;Last-Modified的不足&quot;">​</a></h4><p>前面的<code>Expires</code>遗留的，客户端时间可能被修改的问题，那么加上<code>Last-Modified</code>在服务器判断该文件的最后修改时间，这下应该没有啥问题了吧？还是会存在两个问题：<br> 1、<code>Last-Modified</code>颗粒度是秒级的，操作该文件资源的时间如果是毫秒、甚至纳秒，那不是也完犊子了么？<br> 2、我就是不改文件内容，我只把文件的最后修改时间改了，欸，干得漂亮！！！所以这时候我们就不得不引出另一组<code>header</code>头了。</p><h4 id="etag" tabindex="-1">ETag <a class="header-anchor" href="#etag" aria-label="Permalink to &quot;ETag&quot;">​</a></h4><p>强<code>ETag</code>生成hash字符串 需要大量的算法计算,根据文件的内容生成，如果文件几个G，那就。。。</p><p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/d6e82674dd384eaf94f87dc852aa11cb~tplv-k3u1fbpfcp-watermark.image?" alt="image.png"> <br> 弱<code>ETag</code>表现形式就是<code>W/ +hash</code>, W的大小写敏感，弱<code>Etag</code>一般：文件最后修改时间+时间戳+部分内容生成<code>hash</code>\</p><p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/8374519bc7b648d795d7ceada56ea5a0~tplv-k3u1fbpfcp-watermark.image?" alt="image.png"><br><strong>ETag是可以根据场景自定义</strong><br><code>ETag</code>﻿ =》<code>If-None-Match</code>表示资源内容是否被更改，一般为<code>hash</code>值<br><code>设置ETag头</code>\</p><div class="language-typescript"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">res</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">setHeader</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">Cache-Control</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">no-cache</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">res</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">setHeader</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">etag</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> etag)</span></span>
<span class="line"></span></code></pre></div><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/11fff46309904082a806280e3913d11d~tplv-k3u1fbpfcp-watermark.image?" alt="image.png"><br> 这里我们发现，第一次请求，响应头里面有了<code>etag</code>,是个<code>hash</code>值, 状态码为<code>200</code></p><p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/ddcd35676c654105b6caf945bfd7ff03~tplv-k3u1fbpfcp-watermark.image?" alt="image.png"><br> 我们第二次请求时，服务器接收到了请求，通过请求头携带的<code>if-modified-since </code>也就是第一次请求的响应头<code>etag</code>,对比结果为一致，表明，该资源未发生变化，所以可以继续使用缓存。这时候，小伙伴们可能又问了：<code>etag</code>是怎么生成的<code>hash</code>值，怎么确保这个<code>hash</code>值，没有改变，内容就一定没有发生改变呀？我们先放放，先来看看缓存优先级的问题。</p><h3 id="缓存优先级的校验" tabindex="-1">缓存优先级的校验 <a class="header-anchor" href="#缓存优先级的校验" aria-label="Permalink to &quot;缓存优先级的校验&quot;">​</a></h3><h4 id="_1、expires-和etag" tabindex="-1">1、Expires 和ETag <a class="header-anchor" href="#_1、expires-和etag" aria-label="Permalink to &quot;1、Expires 和ETag&quot;">​</a></h4><p><code>Expires 和ETag</code>\</p><div class="language-typescript"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;">...</span></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> hash </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> crypto</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">createHash</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">md5</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> etag </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> hash</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">update</span><span style="color:#A6ACCD;">(fs</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">readFileSync</span><span style="color:#A6ACCD;">(url))</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">digest</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">hex</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#A6ACCD;"> (headers</span><span style="color:#89DDFF;">?.</span><span style="color:#A6ACCD;">[</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">if-none-match</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">] ) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;"> (</span><span style="color:#A6ACCD;">headers</span><span style="color:#89DDFF;">?.</span><span style="color:#F07178;">[</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">if-none-match</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">] </span><span style="color:#89DDFF;">==</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">etag</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">res</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">statusCode</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#F78C6C;">304</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#82AAFF;">resolve</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">{</span><span style="color:#F07178;">data</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;">&#39;&#39;</span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">res</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">setHeader</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">Expires</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">Date</span><span style="color:#A6ACCD;">(now </span><span style="color:#89DDFF;">+</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">5</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">60</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">1000</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">toUTCString</span><span style="color:#A6ACCD;">())</span></span>
<span class="line"><span style="color:#A6ACCD;">res</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">setHeader</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">etag</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> etag)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">...</span></span>
<span class="line"></span></code></pre></div><p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/2ffa9108ff6a4c4489c0e3c21ce84f2f~tplv-k3u1fbpfcp-watermark.image?" alt="image.png"><br> 上图为请求<code>img3</code>图片的结果图，响应头同时设置了<code>Etag</code>和<code>Expires</code>，第一次请求走到了服务器，第二次就取的缓存了。<code>Expires</code>强制缓存优先级 大于<code>Etag</code>协商缓存。当然<code>Expires</code>和<code>last-modified</code>也是一样的结果，我这里就不做演示了。</p><h4 id="_2、expires-和-cache-control" tabindex="-1">2、Expires 和 Cache-Control <a class="header-anchor" href="#_2、expires-和-cache-control" aria-label="Permalink to &quot;2、Expires 和 Cache-Control&quot;">​</a></h4><div class="language-typescript"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">res</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">setHeader</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">Expires</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">Date</span><span style="color:#A6ACCD;">(now </span><span style="color:#89DDFF;">+</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">5</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">60</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">1000</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">toUTCString</span><span style="color:#A6ACCD;">())</span></span>
<span class="line"><span style="color:#A6ACCD;">res</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">setHeader</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">Cache-Control</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">no-cache</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"></span></code></pre></div><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/7902e43094644cd483619f1686032a65~tplv-k3u1fbpfcp-watermark.image?" alt="image.png"><br> 从代码来看，我同时设置了<code>Expires</code>和<code>Cache-Control</code>，强制缓存给的 5分钟后过期，<code>Cache-Control:&#39;no-cache&#39;</code>给的是每次使用缓存都去服务端校验，请求了两次，后端接收到了两次请求，说明，<code>Cache-Control</code>优先级是比<code>Expires</code>高的。</p><h4 id="_3、max-age-和-etag" tabindex="-1">3、max-age 和 etag <a class="header-anchor" href="#_3、max-age-和-etag" aria-label="Permalink to &quot;3、max-age 和 etag&quot;">​</a></h4><div class="language-typescript"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> hash </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> crypto</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">createHash</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">md5</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> etag </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> hash</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">update</span><span style="color:#A6ACCD;">(fs</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">readFileSync</span><span style="color:#A6ACCD;">(url))</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">digest</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">hex</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#A6ACCD;"> (headers</span><span style="color:#89DDFF;">?.</span><span style="color:#A6ACCD;">[</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">if-none-match</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">] ) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;"> (</span><span style="color:#A6ACCD;">headers</span><span style="color:#89DDFF;">?.</span><span style="color:#F07178;">[</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">if-none-match</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">] </span><span style="color:#89DDFF;">==</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">etag</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">res</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">statusCode</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#F78C6C;">304</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#82AAFF;">resolve</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">{</span><span style="color:#F07178;">data</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;">&#39;&#39;</span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">res</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">setHeader</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">Cache-Control</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">max-age=120</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">res</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">setHeader</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">etag</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> etag)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span></code></pre></div><p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/48a4c1a92b48417cbde50660c5d7d83c~tplv-k3u1fbpfcp-watermark.image?" alt="image.png"><br> 同时设的<code>max-age=120</code>，也就是强制缓存2分钟，然后又设置了<code>Etag</code>，每次请求的状态码都为<code>200</code>。并且服务器只在第一次接收到了请求，后续的多次都是从缓存中取的，这里验证了：强制缓存优先级高于协商缓存。</p><h2 id="源码地址" tabindex="-1">源码地址 <a class="header-anchor" href="#源码地址" aria-label="Permalink to &quot;源码地址 {#源码地址}&quot;">​</a></h2><p><a href="https://github.com/xiaoyi1255/cache" target="_blank" rel="noreferrer">xiaoyi1255/cache</a></p><h2 id="结论" tabindex="-1">结论 <a class="header-anchor" href="#结论" aria-label="Permalink to &quot;结论 {#结论}&quot;">​</a></h2><ol><li>强制缓存 &gt; 协商缓存</li><li>Cache-Control &gt; Expires</li></ol><h2 id="思考" tabindex="-1">思考 <a class="header-anchor" href="#思考" aria-label="Permalink to &quot;思考 {#思考}&quot;">​</a></h2><ol><li>缓存是存在浏览器端的，那具体是存在什么位置的呢？</li><li>缓存在<code>memory cache</code>和<code>disk cache</code>有什么区别，什么场景使用那种？</li><li>serviceWorker 又是什么？</li></ol></div></div></main><footer class="VPDocFooter" data-v-b7630eba data-v-face870a><!--[--><!--]--><div class="edit-info" data-v-face870a><div class="edit-link" data-v-face870a><a class="VPLink link edit-link-button" href="https://github.com/xiaoyi1255/xiaoyi1255.github.io/edit/master/docs/guide/network/httpCache.md" target="_blank" rel="noreferrer" data-v-face870a data-v-8f4dc553><!--[--><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" class="edit-link-icon" aria-label="edit icon" data-v-face870a><path d="M18,23H4c-1.7,0-3-1.3-3-3V6c0-1.7,1.3-3,3-3h7c0.6,0,1,0.4,1,1s-0.4,1-1,1H4C3.4,5,3,5.4,3,6v14c0,0.6,0.4,1,1,1h14c0.6,0,1-0.4,1-1v-7c0-0.6,0.4-1,1-1s1,0.4,1,1v7C21,21.7,19.7,23,18,23z"></path><path d="M8,17c-0.3,0-0.5-0.1-0.7-0.3C7,16.5,6.9,16.1,7,15.8l1-4c0-0.2,0.1-0.3,0.3-0.5l9.5-9.5c1.2-1.2,3.2-1.2,4.4,0c1.2,1.2,1.2,3.2,0,4.4l-9.5,9.5c-0.1,0.1-0.3,0.2-0.5,0.3l-4,1C8.2,17,8.1,17,8,17zM9.9,12.5l-0.5,2.1l2.1-0.5l9.3-9.3c0.4-0.4,0.4-1.1,0-1.6c-0.4-0.4-1.2-0.4-1.6,0l0,0L9.9,12.5z M18.5,2.5L18.5,2.5L18.5,2.5z"></path></svg> Edit this page on GitHub<!--]--><!----></a></div><div class="last-updated" data-v-face870a><p class="VPLastUpdated" data-v-face870a data-v-7b3ebfe1>Last updated: <time datetime="2023-08-04T15:04:55.000Z" data-v-7b3ebfe1></time></p></div></div><div class="prev-next" data-v-face870a><div class="pager" data-v-face870a><a class="pager-link prev" href="/guide/vue/watch" data-v-face870a><span class="desc" data-v-face870a>Previous page</span><span class="title" data-v-face870a>watch & watchEffect</span></a></div><div class="has-prev pager" data-v-face870a><a class="pager-link next" href="/guide/network/serviceWorker" data-v-face870a><span class="desc" data-v-face870a>Next page</span><span class="title" data-v-face870a>service Worker缓存</span></a></div></div></footer><!--[--><!--[--><!--[--><div class="page" data-v-ca174175><section class="page-edit" data-v-ca174175><div class="page-edit-read" data-v-ca174175><span class="leancloud-visitors" data-flag-title="默认pageTitle" data-v-ca174175><em class="post-meta-item-text" data-v-ca174175>阅读量： </em><i class="leancloud-visitors-count" data-v-ca174175></i></span></div><div id="vcomments" data-v-ca174175></div></section></div><!--]--><!--]--><!--]--></div></div></div></div></div><!----><!--[--><!--]--></div></div>
    <script>__VP_HASH_MAP__ = JSON.parse("{\"flutter_bool.md\":\"be9a8196\",\"flutter_map.md\":\"cd54bb89\",\"guide_chat_fiveline.md\":\"65400f6b\",\"guide_project_bt_宝塔.md\":\"5be8bd3d\",\"guide_chat_cloud.md\":\"671d86b9\",\"guide_network_datacache.md\":\"db0f095a\",\"guide_network_serviceworker.md\":\"5c9aa957\",\"guide_project_algolia.md\":\"bb24b306\",\"flutter_class.md\":\"b4031e81\",\"flutter_set.md\":\"66d2cd9d\",\"guide_bug_message.md\":\"f8bf17ce\",\"flutter_list.md\":\"8656fc10\",\"guide_network_httpcache.md\":\"e64df2d0\",\"guide_chat_mysql.md\":\"c80a79ac\",\"guide_network_axios.md\":\"3e4de006\",\"index.md\":\"fb3abc10\",\"guide_project_bt_linux.md\":\"b9653fc0\",\"guide_chat_heartbeat.md\":\"56d5b665\",\"guide_chat_uploadlargefile.md\":\"136ea9d3\",\"guide_project_nuxt3.md\":\"4623279f\",\"guide_chat_redis.md\":\"1844df40\",\"guide_chat_token.md\":\"33a109e5\",\"flutter_string.md\":\"e157af98\",\"guide_vue_ref.md\":\"1f9a35e8\",\"guide_chat_websocket2.md\":\"fdf6f1b4\",\"guide_project_nodemailer.md\":\"386a55fd\",\"guide_bug_index.md\":\"d19a3a4a\",\"flutter_num.md\":\"e431da16\",\"guide_project_blog.md\":\"df8ac795\",\"guide_utils_ngrok.md\":\"dae1cdbe\",\"guide_project_obfuscator.md\":\"4c1f0126\",\"flutter_function.md\":\"54083703\",\"guide_chat_wechatlogin.md\":\"24c8693a\",\"guide_chat_websocket.md\":\"3dc17905\",\"guide_vue_effect.md\":\"6d6313c4\",\"guide_js_arraryequal.md\":\"e8b4de69\",\"guide_vue_intercept.md\":\"6e210ca3\",\"guide_chat_emoji.md\":\"30e0d196\",\"guide_vue_reactive.md\":\"4d9c04dd\",\"guide_vue_computed.md\":\"45a12460\",\"guide_vue_watch.md\":\"0bb68b06\",\"guide_project_bt_redis.md\":\"512b1285\",\"guide_test.md\":\"c452dba9\"}")
__VP_SITE_DATA__ = JSON.parse("{\"lang\":\"en-US\",\"dir\":\"ltr\",\"title\":\"小易\",\"description\":\"A VitePress site\",\"base\":\"/\",\"head\":[],\"appearance\":true,\"themeConfig\":{\"nav\":[{\"text\":\"Guide\",\"link\":\"/guide/test\",\"activeMatch\":\"/guide/\"},{\"text\":\"Dart基础语法\",\"collapsed\":true,\"items\":[{\"text\":\"dart基础类型之num\",\"link\":\"/flutter/num\"},{\"text\":\"dart基础类型之Sting\",\"link\":\"/flutter/string\"},{\"text\":\"dart类型之List\",\"link\":\"/flutter/List\"},{\"text\":\"dart类型之Map\",\"link\":\"/flutter/Map\"},{\"text\":\"dart类型之Set\",\"link\":\"/flutter/Set\"},{\"text\":\"dart之Class\",\"link\":\"/flutter/Class\"},{\"text\":\"dart之Function\",\"link\":\"/flutter/Function\"}]}],\"sidebar\":{\"/guide/\":[{\"text\":\"Vue3源码学习\",\"collapsed\":true,\"items\":[{\"text\":\"ref+依赖收集+更新\",\"link\":\"/guide/vue/ref\"},{\"text\":\"reactive\",\"link\":\"/guide/vue/reactive\"},{\"text\":\"computed\",\"link\":\"/guide/vue/computed\"},{\"text\":\"effect\",\"link\":\"/guide/vue/effect\"},{\"text\":\"拦截工具函数\",\"link\":\"/guide/vue/intercept\"},{\"text\":\"watch & watchEffect\",\"link\":\"/guide/vue/watch\"}]},{\"text\":\"网络请求\",\"collapsed\":true,\"items\":[{\"text\":\"http缓存\",\"link\":\"/guide/network/httpCache.md\"},{\"text\":\"service Worker缓存\",\"link\":\"/guide/network/serviceWorker.md\"},{\"text\":\"axios 取消重复请求\",\"link\":\"/guide/network/axios.md\"},{\"text\":\"接口数据缓存\",\"link\":\"/guide/network/dataCache.md\"}]},{\"text\":\"项目搭建\",\"collapsed\":true,\"items\":[{\"text\":\"vitepress搭建技术文档、个人博客\",\"link\":\"/guide/project/blog\"},{\"text\":\"给vitepress加上全局搜索\",\"link\":\"/guide/project/algolia\"},{\"text\":\"nuxt3 搭建项目\",\"link\":\"/guide/project/nuxt3\"},{\"text\":\"nodemailer实现邮件发送\",\"link\":\"/guide/project/nodemailer\"},{\"text\":\"构建高效的聊天室\",\"collapsed\":true,\"items\":[{\"text\":\"1.websocket实现基础通信\",\"link\":\"/guide/chat/websocket\"},{\"text\":\"2.支持图片、视频消息\",\"link\":\"/guide/chat/websocket2\"},{\"text\":\"3.消息转存redis\",\"link\":\"/guide/chat/redis\"},{\"text\":\"4.在线状态管理：心跳机制\",\"link\":\"/guide/chat/heartbeat\"},{\"text\":\"5.实现大文件分片上传\",\"link\":\"/guide/chat/uploadLargeFile\"},{\"text\":\"6.腾讯云服务器进行项目PM2部署\",\"link\":\"/guide/chat/cloud\"},{\"text\":\"7.微信订阅号实现登录\",\"link\":\"/guide/chat/wechatLogin\"},{\"text\":\"8.支持emoji表情\",\"link\":\"/guide/chat/emoji\"},{\"text\":\"9.五子棋在线对战\",\"link\":\"/guide/chat/fiveline\"}]},{\"text\":\"无感刷新Token\",\"link\":\"/guide/chat/token\"},{\"text\":\"vue项目代码混淆\",\"link\":\"/guide/project/obfuscator\"}]},{\"text\":\"JS面试系列\",\"collapsed\":true,\"items\":[{\"text\":\"1、判断两数组内容相等\",\"link\":\"/guide/js/arraryEqual\"}]},{\"text\":\"工具集\",\"collapsed\":true,\"items\":[{\"text\":\"免费的内网穿透工具: ngrok\",\"link\":\"/guide/utils/ngrok\"}]},{\"text\":\"那些年踩过的坑\",\"collapsed\":true,\"items\":[{\"text\":\"同学醒醒，bug来了\",\"link\":\"/guide/bug/index\"},{\"text\":\"ant-design-vue的message\",\"link\":\"/guide/bug/message\"}]}],\"/flutter/\":[{\"text\":\"Dart基础语法\",\"collapsed\":true,\"items\":[{\"text\":\"dart基础类型之num\",\"link\":\"/flutter/num\"},{\"text\":\"dart基础类型之Sting\",\"link\":\"/flutter/string\"},{\"text\":\"dart类型之List\",\"link\":\"/flutter/List\"},{\"text\":\"dart类型之Map\",\"link\":\"/flutter/Map\"},{\"text\":\"dart类型之Set\",\"link\":\"/flutter/Set\"},{\"text\":\"dart之Class\",\"link\":\"/flutter/Class\"},{\"text\":\"dart之Function\",\"link\":\"/flutter/Function\"}]}]},\"editLink\":{\"pattern\":\"https://github.com/xiaoyi1255/xiaoyi1255.github.io/edit/master/docs/:path\",\"text\":\"Edit this page on GitHub\"},\"socialLinks\":[{\"icon\":\"github\",\"link\":\"https://github.com/xiaoyi1255\"}],\"algolia\":{\"appId\":\"IPEOGH904I\",\"apiKey\":\"7001393f64b263b1fc44c1094b263008\",\"indexName\":\"xiaoyi1255io\"}},\"locales\":{},\"scrollOffset\":90,\"cleanUrls\":true}")</script>
    
  </body>
</html>